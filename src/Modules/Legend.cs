using System;
using System.Collections.Generic;
using PhyloTree;
using TreeViewer;
using VectSharp;
using VectSharp.Markdown;

namespace a06888353e9304d08ab245727bced8cd6
{
    /// <summary>
    /// This module renders a snippet of [Markdown](https://en.wikipedia.org/wiki/Markdown) code and draws it on the plot.
    /// This can be used e.g. to display a description or legend of the plot.
    /// </summary>
    /// 
    /// <description>
    /// <![CDATA[
    /// ## Further information
    /// 
    /// In addition to the [Markdown features supported by VectSharp.Markdown](https://github.com/arklumpus/VectSharp/tree/master/VectSharp.Markdown#supported-markdown-features),
    /// this module supports some special image protocols to draw coloured symbols that may aid in creating a legend for
    /// the tree plot.
    /// 
    /// These are used by inserting in the markdown source an image whose address starts with `attachment://`, `circle://`, `ellipse://`,
    /// `square://`, `rect://`, `poly://` or `star://`. For example:
    /// 
    /// ```Markdown
    /// ![](star://8,blue) Blue star
    /// ```
    /// 
    /// Renders to:
    /// 
    /// <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgc29kaXBvZGk6ZG9jbmFtZT0iQmx1ZVN0YXIuc3ZnIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIxLjAgKDQwMzVhNGZiNDksIDIwMjAtMDUtMDEpIgogICBpZD0ic3ZnOTgzIgogICB2ZXJzaW9uPSIxLjEiCiAgIHZpZXdCb3g9IjAgMCAyMC40MjQxNzUgNC45MDc0NDAxIgogICBoZWlnaHQ9IjQuOTA3NDQwMm1tIgogICB3aWR0aD0iMjAuNDI0MTc1bW0iPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM5NzciIC8+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjAiCiAgICAgaW5rc2NhcGU6d2luZG93LXk9IjE2MyIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMzEyIgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9IjExOTgiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxNTQ1IgogICAgIGZpdC1tYXJnaW4tYm90dG9tPSIxIgogICAgIGZpdC1tYXJnaW4tcmlnaHQ9IjEiCiAgICAgZml0LW1hcmdpbi1sZWZ0PSIxIgogICAgIGZpdC1tYXJnaW4tdG9wPSIxIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC1yb3RhdGlvbj0iMCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9Im1tIgogICAgIGlua3NjYXBlOmN5PSI4Ljg3Mzc2NDYiCiAgICAgaW5rc2NhcGU6Y3g9IjU1LjQ4ODY2IgogICAgIGlua3NjYXBlOnpvb209IjMyIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGlkPSJiYXNlIiAvPgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTk4MCI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgICA8ZGM6dGl0bGU+PC9kYzp0aXRsZT4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtODguMDYxNzI0LC0xMjYuMDU4MikiCiAgICAgaWQ9ImxheWVyMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlua3NjYXBlOmxhYmVsPSJMaXZlbGxvIDEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJzdHJva2Utd2lkdGg6MC4zNTI3NzciCiAgICAgICBkPSJtIDg5LjA2MTcyNCwxMjcuMDU4MiBoIDIuODIyMjIyIHYgMi44MjIyMiBoIC0yLjgyMjIyMiB6IgogICAgICAgc3Ryb2tlPSJub25lIgogICAgICAgZmlsbD0iI2ZmZmZmZiIKICAgICAgIGZpbGwtb3BhY2l0eT0iMCIKICAgICAgIGlkPSJwYXRoNiIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0ic3Ryb2tlLXdpZHRoOjAuMzUyNzc3IgogICAgICAgZD0ibSA5MS44ODM5NDYsMTI4LjQ2OTMxIC0wLjg0MDMwNSwwLjQxNDcxIC0wLjEzNDc0OSwwLjkyNzMzIC0wLjY1NDA4NiwtMC42NzEwMiAtMC45MjM1ODQsMC4xNTg0MSAwLjQzNjA1NywtMC44Mjk0MyAtMC40MzYwNTcsLTAuODI5NDMgMC45MjM1ODQsMC4xNTg0IDAuNjU0MDg2LC0wLjY3MTAyIDAuMTM0NzQ5LDAuOTI3MzMgeiIKICAgICAgIHN0cm9rZT0ibm9uZSIKICAgICAgIGZpbGw9IiMwMDAwZmYiCiAgICAgICBmaWxsLW9wYWNpdHk9IjEiCiAgICAgICBpZD0icGF0aDgiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9InN0cm9rZS13aWR0aDowLjI2NDU4MyIKICAgICAgIGQ9Im0gOTMuMjA2MzMzLDEyOS44ODA0MiB2IC0yLjcwMDM0IGggMS4wOTY0MzQgYyAwLjI0OTQxMywwIDAuNDQ0NSwwLjA2MyAwLjU4NTI1OCwwLjE4ODkxIDAuMTQzMjI4LDAuMTI4NDEgMC4yMTQ4NDIsMC4yOTM4NyAwLjIxNDg0MiwwLjQ5NjM2IDAsMC4yNzY1OCAtMC4xMjQ3MDcsMC40NzI5IC0wLjM3NDEyMSwwLjU4ODk2IDAuMTcyODYxLDAuMDY2NyAwLjI5ODE4NSwwLjE1MTg3IDAuMzc1OTczLDAuMjU1NTkgMC4wNzc3OSwwLjEwMzcyIDAuMTE2NjgxLDAuMjM3MDcgMC4xMTY2ODEsMC40MDAwNSAwLDAuMjE3MzEgLTAuMDY5MTUsMC4zOTg4MiAtMC4yMDc0MzMsMC41NDQ1MSAtMC4xNDA3NTksMC4xNTA2NCAtMC4zMzcwNzksMC4yMjU5NiAtMC41ODg5NjMsMC4yMjU5NiB6IG0gMC4zNDQ0ODgsLTEuNTM3MjMgaCAwLjY2Njc1IGMgMC4xNzc4LDAgMC4zMDg2OCwtMC4wMzIxIDAuMzkyNjQyLC0wLjA5NjMgMC4wOTg3OCwtMC4wNzY1IDAuMTQ4MTY2LC0wLjE4NzY4IDAuMTQ4MTY2LC0wLjMzMzM3IDAsLTAuMTQ1NyAtMC4wNDkzOSwtMC4yNTY4MyAtMC4xNDgxNjYsLTAuMzMzMzggLTAuMDgzOTYsLTAuMDY0MiAtMC4yMTQ4NDIsLTAuMDk2MyAtMC4zOTI2NDIsLTAuMDk2MyBoIC0wLjY2Njc1IHogbSAwLDEuMjMzNDkgaCAwLjg0MDg0NiBjIDAuMTUwNjM2LDAgMC4yNjkxNjksLTAuMDQwOCAwLjM1NTYsLTAuMTIyMjQgMC4wODY0MywtMC4wODE1IDAuMTI5NjQ2LC0wLjE5NTA5IDAuMTI5NjQ2LC0wLjM0MDc4IDAsLTAuMTQ1NyAtMC4wNDI2LC0wLjI1OTkxIC0wLjEyNzc5NCwtMC4zNDI2NCAtMC4wODUyLC0wLjA4MjcgLTAuMjA0MzQ3LC0wLjEyNDA5IC0wLjM1NzQ1MiwtMC4xMjQwOSBoIC0wLjg0MDg0NiB6IG0gMi4zOTY1OTYsLTIuMzk2NiB2IDIuNzAwMzQgaCAtMC4zMTExNSB2IC0yLjcwMDM0IHogbSAyLjA0NDcsMi43MDAzNCBoIC0wLjI3NzgxMyB2IC0wLjI3MDQxIGMgLTAuMDkxMzcsMC4xMjg0MSAtMC4xODY0NDMsMC4yMTk3OCAtMC4yODUyMjEsMC4yNzQxMSAtMC4wOTg3OCwwLjA1NDMgLTAuMjE5NzgsMC4wODE1IC0wLjM2MzAwOCwwLjA4MTUgLTAuMTg3Njc4LDAgLTAuMzM3Njk3LC0wLjA0ODEgLTAuNDUwMDU2LC0wLjE0NDQ2IC0wLjExMjM2LC0wLjA5NjMgLTAuMTY4NTQsLTAuMjI0NzIgLTAuMTY4NTQsLTAuMzg1MjMgdiAtMS40OTY0OSBoIDAuMzA3NDQ2IHYgMS4zNzQyNSBjIDAsMC4xMTYwNiAwLjAzNTgxLDAuMjA4NjcgMC4xMDc0MjEsMC4yNzc4MSAwLjA3MTYxLDAuMDY5MiAwLjE2OTE1NywwLjEwMzcyIDAuMjkyNjI5LDAuMTAzNzIgMC4xNjA1MTQsMCAwLjI4ODkyNSwtMC4wNTk5IDAuMzg1MjMzLC0wLjE3OTY1IDAuMDk2MzEsLTAuMTE5NzcgMC4xNDQ0NjMsLTAuMjc4NDMgMC4xNDQ0NjMsLTAuNDc1OTkgdiAtMS4xMDAxNCBoIDAuMzA3NDQ2IHogbSAyLjE3NDM0MywtMC44NjY3OCBoIC0xLjQyOTgwNiBjIDAuMDAyNSwwLjE3NzggMC4wMzcwNCwwLjMxNjA5IDAuMTAzNzE3LDAuNDE0ODcgMC4xMDYxODYsMC4xNjc5MiAwLjI2MTc2MSwwLjI1MTg4IDAuNDY2NzI1LDAuMjUxODggMC4yNTE4ODQsMCAwLjQyMTA0MSwtMC4xMjk2NCAwLjUwNzQ3MSwtMC4zODg5MyBoIDAuMzExMTUzIGMgLTAuMDM5NSwwLjIxMjM3IC0wLjEzMjExOCwwLjM3NzgyIC0wLjI3NzgxNSwwLjQ5NjM1IC0wLjE0NTY5OCwwLjExODU0IC0wLjMyOTY3MSwwLjE3NzggLTAuNTUxOTIxLDAuMTc3OCAtMC4yNzQxMDksMCAtMC40ODk1NjgsLTAuMDkxNCAtMC42NDYzNzgsLTAuMjc0MSAtMC4xNTY4MSwtMC4xODI3NCAtMC4yMzUyMTQsLTAuNDM0NjMgLTAuMjM1MjE0LC0wLjc1NTY1IDAsLTAuMzIxMDMgMC4wODAyNiwtMC41NzY2MiAwLjI0MDc3MSwtMC43NjY3NyAwLjE2MDUxMywtMC4xOTAxNCAwLjM3NjU5LC0wLjI4NTIyIDAuNjQ4MjI5LC0wLjI4NTIyIDAuMTgyNzM5LDAgMC4zNDM4NywwLjA0NTcgMC40ODMzOTQsMC4xMzcwNiAwLjEzOTUyMywwLjA5MTQgMC4yNDAxNTQsMC4yMTYwNyAwLjMwMTg4NCwwLjM3NDEyIDAuMDUxOSwwLjEzNTgyIDAuMDc3OCwwLjM0MjAxIDAuMDc3OCwwLjYxODU5IHogbSAtMS40MjIzOTcsLTAuMjUxODggaCAxLjA4OTAyNSBjIDAsLTAuMTc1MzMgLTAuMDQ5MzksLTAuMzE3OTQgLTAuMTQ4MTY3LC0wLjQyNzgzIC0wLjA5ODc4LC0wLjEwOTg5IC0wLjIyNzE4OSwtMC4xNjQ4NCAtMC4zODUyMzMsLTAuMTY0ODQgLTAuMTU1NTc1LDAgLTAuMjgzOTg3LDAuMDUzNyAtMC4zODUyMzQsMC4xNjExMyAtMC4xMDEyNDcsMC4xMDc0MiAtMC4xNTgwNDQsMC4yNTEyNyAtMC4xNzAzOTEsMC40MzE1NCB6IgogICAgICAgc3Ryb2tlPSJub25lIgogICAgICAgZmlsbD0iIzAwMDAwMCIKICAgICAgIGZpbGwtb3BhY2l0eT0iMSIKICAgICAgIGlkPSJwYXRoMTAiIC8+CiAgICA8cGF0aAogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2Njc2NzY2Nzc2NjY2NjY2NjY2NzY2NzY3NjY2NjY3NzY2NjY3Njc3NzY2NjY2Njc2NzY3NjY2NjY3NjY2NjY2NjIgogICAgICAgc3R5bGU9InN0cm9rZS13aWR0aDowLjI2NDU4MyIKICAgICAgIGQ9Im0gMTAyLjk3NzkyLDEyOC40ODAyNCBoIC0wLjMyNTk2IGMgLTAuMDA3LC0wLjIwNzQzIC0wLjEzNzA2LC0wLjMxMTE1IC0wLjM4ODk0LC0wLjMxMTE1IC0wLjEyNTk0LDAgLTAuMjI1OTUsMC4wMjU5IC0wLjMwMDA0LDAuMDc3OCAtMC4wNzQxLDAuMDUxOSAtMC4xMTExMiwwLjEyMzQ3IC0wLjExMTEyLDAuMjE0ODQgMCwwLjA2OTEgMC4wMjg0LDAuMTI1MzMgMC4wODUyLDAuMTY4NTQgMC4wNTY4LDAuMDQzMiAwLjE0ODE2LDAuMDc5NiAwLjI3NDExLDAuMTA5MjcgbCAwLjI5NjMzLDAuMDcwNCBjIDAuMTkyNjIsMC4wNDY5IDAuMzMyMTQsMC4xMTI5OCAwLjQxODU3LDAuMTk4MTggMC4wODY0LDAuMDg1MiAwLjEyOTY1LDAuMTk5NCAwLjEyOTY1LDAuMzQyNjMgMCwwLjE4NzY4IC0wLjA3MjIsMC4zMzcwOCAtMC4yMTY3LDAuNDQ4MjEgLTAuMTQ0NDYsMC4xMTExMiAtMC4zMzg5MywwLjE2NjY4IC0wLjU4MzQsMC4xNjY2OCAtMC41MDEzLDAgLTAuNzU5MzYsLTAuMjIxMDEgLTAuNzc0MTcsLTAuNjYzMDQgaCAwLjMyNTk2IGMgMC4wMTQ4LDAuMTE2MDYgMC4wNDQ0LDAuMTk4NzkgMC4wODg5LDAuMjQ4MTggMC4wODE1LDAuMDg2NCAwLjIwOTksMC4xMjk2NCAwLjM4NTI0LDAuMTI5NjQgMC4xMzU4MSwwIDAuMjQ1MDksLTAuMDI4NCAwLjMyNzgxLC0wLjA4NTIgMC4wODI3LC0wLjA1NjggMC4xMjQwOSwtMC4xMzA4OCAwLjEyNDA5LC0wLjIyMjI1IDAsLTAuMDY5MiAtMC4wMjM1LC0wLjEyNDcxIC0wLjA3MDQsLTAuMTY2NjkgLTAuMDQ2OSwtMC4wNDIgLTAuMTIzNDcsLTAuMDc1MyAtMC4yMjk2NSwtMC4xMDAwMSBsIC0wLjI4ODkzLC0wLjA3MDQgYyAtMC4yMjk2NiwtMC4wNTQzIC0wLjM4OTU2LC0wLjEyMjg2IC0wLjQ3OTY5LC0wLjIwNTU4IC0wLjA5MDEsLTAuMDgyNyAtMC4xMzUyLC0wLjIwMDY1IC0wLjEzNTIsLTAuMzUzNzUgMCwtMC4xODAyNyAwLjA2NTgsLTAuMzI2MTkgMC4yMDE2NSwtMC40MzM2MSAwLjEzNTgyLC0wLjEwNzQyIDAuMzIwMjMsLTAuMTY3MzMgMC41NDQ5NSwtMC4xNjczMyAwLjIyNDcyLDAgMC4zOTk2NCwwLjA2MDIgMC41MjA2NSwwLjE2Mzg1IDAuMTIxLDAuMTAzNzEgMC4xNzg2MSwwLjI1MDY1IDAuMTgxMDcsMC40NDA3OSB6IG0gMS4xNzA1MiwtMC41NDA4MSB2IDAuMjUxODkgaCAtMC4zMTg1NiB2IDEuMzI5NzkgYyAwLDAuMDY5MiAwLjAxMTcsMC4xMTU0NSAwLjAzNTIsMC4xMzg5MSAwLjAyMzUsMC4wMjM1IDAuMDY4NSwwLjAzNTIgMC4xMzUyMSwwLjAzNTIgMC4wNTkzLDAgMC4xMDg2NSwtMC4wMDUgMC4xNDgxNiwtMC4wMTQ4IHYgMC4yNTkyOSBjIC0wLjA5NjMsMC4wMTczIC0wLjE4MDI3LDAuMDI1OSAtMC4yNTE4OCwwLjAyNTkgLTAuMjQ5NDEsMCAtMC4zNzQxMiwtMC4xMDI0OCAtMC4zNzQxMiwtMC4zMDc0NCB2IC0xLjQ2Njg1IGggLTAuMjYzIHYgLTAuMjUxODkgaCAwLjI2MyB2IC0wLjUzMzQgaCAwLjMwNzQ0IHYgMC41MzM0IHogbSAyLjA3MDYzLDEuNzU5NDggdiAwLjIzMzM3IGMgLTAuMDg4OSwwLjAyMjIgLTAuMTU5MjgsMC4wMzMzIC0wLjIxMTE0LDAuMDMzMyAtMC4xMDEyNCwwIC0wLjE3NzE4LC0wLjAyMjggLTAuMjI3OCwtMC4wNjg1IC0wLjA1MDYsLTAuMDQ1NyAtMC4wODA5LC0wLjExNzkyIC0wLjA5MDcsLTAuMjE2NyAtMC4yMDc0NCwwLjE5MDE1IC0wLjQyNzIyLDAuMjg1MjIgLTAuNjU5MzQsMC4yODUyMiAtMC4xOTUwOSwwIC0wLjM1MDA1LC0wLjA1MTkgLTAuNDY0ODgsLTAuMTU1NTcgLTAuMTE0ODMsLTAuMTAzNzIgLTAuMTcyMjQsLTAuMjQzMjQgLTAuMTcyMjQsLTAuNDE4NTcgMCwtMC4yNDk0MiAwLjExMzU5LC0wLjQyMjI4IDAuMzQwNzgsLTAuNTE4NTkgMC4wNjE3LC0wLjAyNDcgMC4xMjcxOCwtMC4wNDM4IDAuMTk2MzIsLTAuMDU3NCAwLjA2OTIsLTAuMDEzNiAwLjIxMTE0LC0wLjAzNCAwLjQyNTk4LC0wLjA2MTEgMC4xMjU5NCwtMC4wMTczIDAuMjEwNTIsLTAuMDQwNyAwLjI1Mzc0LC0wLjA3MDQgMC4wNDMyLC0wLjAyOTYgMC4wNjYxLC0wLjA3NzggMC4wNjg1LC0wLjE0NDQ2IHYgLTAuMDgxNSBjIDAsLTAuMTkyNjIgLTAuMTQ0NDYsLTAuMjg4OTMgLTAuNDMzMzksLTAuMjg4OTMgLTAuMTQzMjMsMCAtMC4yNTE4OCwwLjAyNzggLTAuMzI1OTcsMC4wODMzIC0wLjA3NDEsMC4wNTU2IC0wLjExNzI5LDAuMTQyNjEgLTAuMTI5NjQsMC4yNjExNCBoIC0wLjMxMTE1IGMgMC4wMDcsLTAuMTc3OCAwLjA1MTksLTAuMzEyMzggMC4xMzMzNSwtMC40MDM3NSAwLjEzODI5LC0wLjE1MDY0IDAuMzUzMTMsLTAuMjI1OTYgMC42NDQ1MiwtMC4yMjU5NiAwLjIzOTU0LDAgMC40MjEwNCwwLjA0NTEgMC41NDQ1MiwwLjEzNTIgMC4xMjM0NywwLjA5MDEgMC4xODUyLDAuMjIxNjQgMC4xODUyLDAuMzk0NSB2IDEuMTQwODggYyAwLDAuMTAxMjUgMC4wNTU2LDAuMTUxODcgMC4xNjY2OSwwLjE1MTg3IDAuMDIyMiwwIDAuMDQ0NCwtMC4wMDIgMC4wNjY3LC0wLjAwNyB6IG0gLTAuNTQwODEsLTAuNDI5NjggdiAtMC4zNDgxOSBjIC0wLjA4MTUsMC4wMzcgLTAuMjQ2OTQsMC4wNzI4IC0wLjQ5NjM2LDAuMTA3NDIgLTAuMTY1NDUsMC4wMjQ3IC0wLjI4NDYsMC4wNjQ4IC0wLjM1NzQ1LDAuMTIwMzggLTAuMDcyOSwwLjA1NTYgLTAuMTA5MjcsMC4xMzM5NyAtMC4xMDkyNywwLjIzNTIyIDAsMC4wOTg4IDAuMDMzMywwLjE3NTMzIDAuMTAwMDEsMC4yMjk2NiAwLjA2NjcsMC4wNTQzIDAuMTYwNTIsMC4wODE1IDAuMjgxNTIsMC4wODE1IDAuMTc3OCwwIDAuMzMwOSwtMC4wNTggMC40NTkzMSwtMC4xNzQxIDAuMDgxNSwtMC4wNzQxIDAuMTIyMjQsLTAuMTU4MDQgMC4xMjIyNCwtMC4yNTE4OCB6IG0gMC44NzQxOSwtMS4zMjk4IGggMC4yODUyMiB2IDAuMzUxOSBjIDAuMDg4OSwtMC4xNDU3IDAuMTc0NzEsLTAuMjUwMDMgMC4yNTc0NCwtMC4zMTMgMC4wODI3LC0wLjA2MyAwLjE3MzQ3LC0wLjA5NDUgMC4yNzIyNSwtMC4wOTQ1IDAuMDI3MiwwIDAuMDY2NywwLjAwNCAwLjExODU0LDAuMDExMSB2IDAuMzE0ODYgYyAtMC4yMTIzOCwtMC4wMDUgLTAuMzY4NTcsMC4wNDU3IC0wLjQ2ODU4LDAuMTUxODcgLTAuMTAwMDEsMC4xMDYxOSAtMC4xNTEyNSwwLjI3NjU4IC0wLjE1MzcyLDAuNTExMTcgdiAxLjAwNzU0IGggLTAuMzExMTUgeiIKICAgICAgIHN0cm9rZT0ibm9uZSIKICAgICAgIGZpbGw9IiMwMDAwMDAiCiAgICAgICBmaWxsLW9wYWNpdHk9IjEiCiAgICAgICBpZD0icGF0aDEyIiAvPgogIDwvZz4KPC9zdmc+Cg==" />
    ///
    /// After the special protocol, you need to supply a series of parameters that will be used to determine the size
    /// and colour of the shape that is drawn:
    /// 
    /// * `attachment://<name>`
    /// 
    ///     This includes the image contained in the attachment with the specified name in the Markdown document. The
    ///     correct format for the image is chosen automatically.
    ///
    ///        Example:
    ///
    ///        * `attachment://Legend`    
    /// 
    /// * `circle://<diameter>,<colour>[,<stroke thickness>[,<stroke colour>]]`
    /// 
    ///     This draws a circle with the specified diameter and colour. The `stroke thickness` and `stroke colour`
    ///     parameters can be omitted, in which case the circle will only be filled and not stroked.
    /// 
    ///     Examples:
    /// 
    ///     * `circle://8,cornflowerblue` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSIgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiPgogIDxwYXRoIGQ9Im05OC43NTcgMTI2LjAxaDIuODIyMnYyLjgyMjJoLTIuODIyMnoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogIDxwYXRoIGQ9Im0xMDEuNTggMTI3LjQyYzAgMC43Nzg4MS0wLjYzMjMgMS40MTExLTEuNDExMSAxLjQxMTFzLTEuNDExMS0wLjYzMjMtMS40MTExLTEuNDExMSAwLjYzMjMtMS40MTExIDEuNDExMS0xLjQxMTEgMS40MTExIDAuNjMyMyAxLjQxMTEgMS40MTExeiIgZmlsbD0iIzY0OTVlZCIvPgogPC9nPgo8L3N2Zz4K" />
    ///     * `circle://6,#009e76,1,black` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSIgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiPgogIDxwYXRoIGQ9Im05OC45MzMgMTI2LjE4aDIuNDY5NHYyLjQ2OTRoLTIuNDY5NHoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogIDxwYXRoIGQ9Im0xMDEuMjMgMTI3LjQyYzAgMC41ODQxLTAuNDc0MjIgMS4wNTgzLTEuMDU4MyAxLjA1ODMtMC41ODQxMSAwLTEuMDU4My0wLjQ3NDIzLTEuMDU4My0xLjA1ODMgMC0wLjU4NDExIDAuNDc0MjItMS4wNTgzIDEuMDU4My0xLjA1ODMgMC41ODQxMSAwIDEuMDU4MyAwLjQ3NDIyIDEuMDU4MyAxLjA1ODN6IiBmaWxsPSIjMDA5ZTc2Ii8+CiAgPHBhdGggZD0ibTEwMS4yMyAxMjcuNDJjMCAwLjU4NDEtMC40NzQyMiAxLjA1ODMtMS4wNTgzIDEuMDU4My0wLjU4NDExIDAtMS4wNTgzLTAuNDc0MjMtMS4wNTgzLTEuMDU4MyAwLTAuNTg0MTEgMC40NzQyMi0xLjA1ODMgMS4wNTgzLTEuMDU4MyAwLjU4NDExIDAgMS4wNTgzIDAuNDc0MjIgMS4wNTgzIDEuMDU4M3oiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMCIvPgogPC9nPgo8L3N2Zz4K" />
    ///     * `circle://10,,1,orange` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgaW5rc2NhcGU6dmVyc2lvbj0iMS4wICg0MDM1YTRmYjQ5LCAyMDIwLTA1LTAxKSIKICAgc29kaXBvZGk6ZG9jbmFtZT0iT3JhbmdlQ2lyY2xlLnN2ZyIKICAgaWQ9InN2ZzEwIgogICB2aWV3Qm94PSIwIDAgNi41IDYuNSIKICAgdmVyc2lvbj0iMS4xIgogICBoZWlnaHQ9IjYuNW1tIgogICB3aWR0aD0iNi41bW0iPgogIDxkZWZzCiAgICAgaWQ9ImRlZnMxNCIgLz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0iZzgiCiAgICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMCIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMCIKICAgICBpbmtzY2FwZTpjeT0iOC4wMzIzMjc2IgogICAgIGlua3NjYXBlOmN4PSI3LjkzODUwMjciCiAgICAgaW5rc2NhcGU6em9vbT0iMjAuNTE1Mzg1IgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpZD0ibmFtZWR2aWV3MTIiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iMTAyNiIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjE1MTEiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMCIKICAgICBndWlkZXRvbGVyYW5jZT0iMTAiCiAgICAgZ3JpZHRvbGVyYW5jZT0iMTAiCiAgICAgb2JqZWN0dG9sZXJhbmNlPSIxMCIKICAgICBib3JkZXJvcGFjaXR5PSIxIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIgLz4KICA8bWV0YWRhdGEKICAgICBpZD0ibWV0YWRhdGEyIj4KICAgIDxyZGY6UkRGPgogICAgICA8Y2M6V29yawogICAgICAgICByZGY6YWJvdXQ9IiI+CiAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+CiAgICAgICAgPGRjOnR5cGUKICAgICAgICAgICByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIiAvPgogICAgICAgIDxkYzp0aXRsZT48L2RjOnRpdGxlPgogICAgICA8L2NjOldvcms+CiAgICA8L3JkZjpSREY+CiAgPC9tZXRhZGF0YT4KICA8ZwogICAgIGlkPSJnOCIKICAgICBzdHJva2Utd2lkdGg9Ii4zNTI3OCIKICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtOTYuOTE4IC0xMjQuMTcpIj4KICAgIDxwYXRoCiAgICAgICBpZD0icGF0aDQiCiAgICAgICBmaWxsLW9wYWNpdHk9IjAiCiAgICAgICBmaWxsPSIjZmZmIgogICAgICAgZD0ibTk4LjIyOCAxMjUuNDhoMy44ODA2djMuODgwNmgtMy44ODA2eiIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjY2NjIgogICAgICAgaWQ9InBhdGg2IgogICAgICAgc3Ryb2tlPSIjZmZhNTAwIgogICAgICAgZmlsbD0ibm9uZSIKICAgICAgIGQ9Im0gMTAxLjkzLDEyNy40MiBjIDAsMC45NzM1MiAtMC43OTAzOCwxLjc2MzkgLTEuNzYzOSwxLjc2MzkgLTAuOTczNTIsMCAtMS43NjM5LC0wLjc5MDM3IC0xLjc2MzksLTEuNzYzOSAwLC0wLjk3MzUzIDAuNzkwMzcsLTEuNzYzOSAxLjc2MzksLTEuNzYzOSAwLjk3MzUxLDAgMS43NjM5LDAuNzkwMzcgMS43NjM5LDEuNzYzOSB6IiAvPgogIDwvZz4KPC9zdmc+Cg==" />
    /// 
    /// * `ellipse://<width>,<height>,<colour>[,<stroke thickness>[,<stroke colour>]]`
    /// 
    ///     This draws an ellipse with the specified width, height and colour. The `stroke thickness` and `stroke colour`
    ///     parameters can be omitted, in which case the ellipse will only be filled and not stroked.
    /// 
    ///     Examples:
    /// 
    ///     * `ellipse://12,8,cornflowerblue` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgaW5rc2NhcGU6dmVyc2lvbj0iMS4wICg0MDM1YTRmYjQ5LCAyMDIwLTA1LTAxKSIKICAgc29kaXBvZGk6ZG9jbmFtZT0iRWxsaXBzZTEuc3ZnIgogICBpZD0ic3ZnMTAiCiAgIHZpZXdCb3g9IjAgMCA2LjUgNi41IgogICB2ZXJzaW9uPSIxLjEiCiAgIGhlaWdodD0iNi41bW0iCiAgIHdpZHRoPSI2LjVtbSI+CiAgPGRlZnMKICAgICBpZD0iZGVmczE0IiAvPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJzdmcxMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctbWF4aW1pemVkPSIxIgogICAgIGlua3NjYXBlOndpbmRvdy15PSItOCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iLTgiCiAgICAgaW5rc2NhcGU6Y3k9IjEyLjI4MzQ2NSIKICAgICBpbmtzY2FwZTpjeD0iMTIuMjgzNDY1IgogICAgIGlua3NjYXBlOnpvb209IjQxLjAzMDc2OSIKICAgICBzaG93Z3JpZD0iZmFsc2UiCiAgICAgaWQ9Im5hbWVkdmlldzEyIgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9IjEzNzciCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIyNTYwIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAiCiAgICAgZ3VpZGV0b2xlcmFuY2U9IjEwIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwIgogICAgIG9iamVjdHRvbGVyYW5jZT0iMTAiCiAgICAgYm9yZGVyb3BhY2l0eT0iMSIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiIC8+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhMiI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgICA8ZGM6dGl0bGUgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpZD0iZzgiCiAgICAgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiCiAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSI+CiAgICA8cGF0aAogICAgICAgaWQ9InBhdGg0IgogICAgICAgZmlsbC1vcGFjaXR5PSIwIgogICAgICAgZmlsbD0iI2ZmZiIKICAgICAgIGQ9Im05OC4wNTEgMTI2LjAxaDQuMjMzM3YyLjgyMjJoLTQuMjMzM3oiIC8+CiAgICA8cGF0aAogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2NjYyIKICAgICAgIGlkPSJwYXRoNiIKICAgICAgIGZpbGw9IiM2NDk1ZWQiCiAgICAgICBkPSJtIDEwMi4yOCwxMjcuNDIgYyAwLDAuNzc4ODEgLTAuOTQ4NDUsMS40MTExIC0yLjExNjcsMS40MTExIC0xLjE2ODIsMCAtMi4xMTY3LC0wLjYzMjMgLTIuMTE2NywtMS40MTExIDAsLTAuNzc4OCAwLjk0ODQ1LC0xLjQxMTEgMi4xMTY3LC0xLjQxMTEgMS4xNjgyLDAgMi4xMTY3LDAuNjMyMyAyLjExNjcsMS40MTExIHoiIC8+CiAgPC9nPgo8L3N2Zz4K" />
    ///     * `ellipse://10,6,#009e76,1,black` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSIgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiPgogIDxwYXRoIGQ9Im05OC4yMjggMTI2LjE4aDMuODgwNnYyLjQ2OTRoLTMuODgwNnoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogIDxwYXRoIGQ9Im0xMDEuOTMgMTI3LjQyYzAgMC41ODQxMS0wLjc5MDM3IDEuMDU4My0xLjc2MzkgMS4wNTgzLTAuOTczNTIgMC0xLjc2MzktMC40NzQyNC0xLjc2MzktMS4wNTgzIDAtMC41ODQxMSAwLjc5MDM3LTEuMDU4MyAxLjc2MzktMS4wNTgzIDAuOTczNTIgMCAxLjc2MzkgMC40NzQyMiAxLjc2MzkgMS4wNTgzeiIgZmlsbD0iIzAwOWU3NiIvPgogIDxwYXRoIGQ9Im0xMDEuOTMgMTI3LjQyYzAgMC41ODQxMS0wLjc5MDM3IDEuMDU4My0xLjc2MzkgMS4wNTgzLTAuOTczNTIgMC0xLjc2MzktMC40NzQyNC0xLjc2MzktMS4wNTgzIDAtMC41ODQxMSAwLjc5MDM3LTEuMDU4MyAxLjc2MzktMS4wNTgzIDAuOTczNTIgMCAxLjc2MzkgMC40NzQyMiAxLjc2MzkgMS4wNTgzeiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIi8+CiA8L2c+Cjwvc3ZnPgo=" />
    ///     * `ellipse://8,10,,1,orange` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSIgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiPgogIDxwYXRoIGQ9Im05OC41OCAxMjUuNDhoMy4xNzV2My44ODA2aC0zLjE3NXoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogIDxwYXRoIGQ9Im0xMDEuNTggMTI3LjQyYzAgMC45NzM1MS0wLjYzMjMgMS43NjM5LTEuNDExMSAxLjc2MzlzLTEuNDExMS0wLjc5MDM4LTEuNDExMS0xLjc2MzljMC0wLjk3MzUyIDAuNjMyMy0xLjc2MzkgMS40MTExLTEuNzYzOXMxLjQxMTEgMC43OTAzNyAxLjQxMTEgMS43NjM5eiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmZhNTAwIi8+CiA8L2c+Cjwvc3ZnPgo=" />
    /// 
    /// * `square://<size>,<colour>[,<stroke thickness>[,<stroke colour>]]`
    /// 
    ///     This draws a square with the specified size and colour. The `stroke thickness` and `stroke colour`
    ///     parameters can be omitted, in which case the square will only be filled and not stroked.
    /// 
    ///     Examples:
    /// 
    ///     * `square://8,cornflowerblue` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSIgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiPgogIDxwYXRoIGQ9Im05OC43NTcgMTI2LjAxaDIuODIyMnYyLjgyMjJoLTIuODIyMnoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogIDxwYXRoIGQ9Im05OC43NTcgMTI2LjAxaDIuODIyMnYyLjgyMjJoLTIuODIyMnoiIGZpbGw9IiM2NDk1ZWQiLz4KIDwvZz4KPC9zdmc+Cg==" />
    ///     * `square://6,#009e76,1,black` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSIgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiPgogIDxwYXRoIGQ9Im05OC45MzMgMTI2LjE4aDIuNDY5NXYyLjQ2OTRoLTIuNDY5NXoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogIDxwYXRoIGQ9Im05OS4xMSAxMjYuMzZoMi4xMTY3djIuMTE2N2gtMi4xMTY3eiIgZmlsbD0iIzAwOWU3NiIvPgogIDxwYXRoIGQ9Im05OS4xMSAxMjYuMzZoMi4xMTY3djIuMTE2N2gtMi4xMTY3eiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIi8+CiA8L2c+Cjwvc3ZnPgo=" />
    ///     * `square://10,,1,orange` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSIgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiPgogIDxwYXRoIGQ9Im05OC4yMjggMTI1LjQ4aDMuODgwNnYzLjg4MDZoLTMuODgwNnoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogIDxwYXRoIGQ9Im05OC40MDQgMTI1LjY1aDMuNTI3OHYzLjUyNzhoLTMuNTI3OHoiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmYTUwMCIvPgogPC9nPgo8L3N2Zz4K" />
    /// 
    /// * `rect://<width>,<height>,<colour>[,<stroke thickness>[,<stroke colour>]]`
    /// 
    ///     This draws a rectangle with the specified width, height and colour. The `stroke thickness` and `stroke colour`
    ///     parameters can be omitted, in which case the rectangle will only be filled and not stroked.
    /// 
    ///     Examples:
    /// 
    ///     * `rect://12,8,cornflowerblue` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSIgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiPgogIDxwYXRoIGQ9Im05OC4wNTEgMTI2LjAxaDQuMjMzM3YyLjgyMjJoLTQuMjMzM3oiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogIDxwYXRoIGQ9Im05OC4wNTEgMTI2LjAxaDQuMjMzM3YyLjgyMjJoLTQuMjMzM3oiIGZpbGw9IiM2NDk1ZWQiLz4KIDwvZz4KPC9zdmc+Cg==" />
    ///     * `rect://10,6,#009e76,1,black` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSIgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiPgogIDxwYXRoIGQ9Im05OC4yMjggMTI2LjE4aDMuODgwNnYyLjQ2OTRoLTMuODgwNnoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogIDxwYXRoIGQ9Im05OC40MDQgMTI2LjM2aDMuNTI3OHYyLjExNjdoLTMuNTI3OHoiIGZpbGw9IiMwMDllNzYiLz4KICA8cGF0aCBkPSJtOTguNDA0IDEyNi4zNmgzLjUyNzh2Mi4xMTY3aC0zLjUyNzh6IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAiLz4KIDwvZz4KPC9zdmc+Cg==" />
    ///     * `rect://8,10,,1,orange` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSIgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiPgogIDxwYXRoIGQ9Im05OC41OCAxMjUuNDhoMy4xNzV2My44ODA2aC0zLjE3NXoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogIDxwYXRoIGQ9Im05OC43NTcgMTI1LjY1aDIuODIyMnYzLjUyNzhoLTIuODIyMnoiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmYTUwMCIvPgogPC9nPgo8L3N2Zz4K" />
    /// 
    /// * `poly://<width>[,<height>],<colour>[,<sides>[,<stroke thickness>[,<stroke colour>]]]`
    /// 
    ///     This draws a polygon with the specified width, height, colour and number of sides. The `stroke thickness`
    ///     and `stroke colour` parameters can be omitted, in which case the polygon will only be filled and not stroked.
    ///     If the `height` is omitted, it will be equal to the `width`. If the number of `sides` is omitted, it will be
    ///     equal to `3`.
    /// 
    ///     Examples:
    /// 
    ///     * `poly://8,cornflowerblue` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSI+CiAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLjAyMjcyMiAtLjE0MDk4KSIgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiPgogICA8cGF0aCBkPSJtOTguNzM0IDEyNi4xNWgyLjgyMjJ2Mi44MjIyaC0yLjgyMjJ6IiBmaWxsPSIjZmZmIiBmaWxsLW9wYWNpdHk9IjAiLz4KICAgPHBhdGggZD0ibTEwMS41NiAxMjcuNTYtMi4xMTY3IDEuMjIyMXYtMi40NDQxeiIgZmlsbD0iIzY0OTVlZCIvPgogIDwvZz4KIDwvZz4KPC9zdmc+Cg==" />
    ///     * `poly://10,6,#009e76,5,1,black` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSI+CiAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLS41MTUxNiAuMjY4MjcpIiBzdHJva2Utd2lkdGg9Ii4zNTI3OCI+CiAgIDxwYXRoIGQ9Im05OC42OTIgMTI1LjkyaDMuODgwNnYyLjQ2OTRoLTMuODgwNnoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogICA8cGF0aCBkPSJtMTAyLjQgMTI3LjE1LTEuMjE4OCAxLjAwNjUtMS45NzIxLTAuMzg0NDZ2LTEuMjQ0MmwxLjk3MjEtMC4zODQ0NnoiIGZpbGw9IiMwMDllNzYiLz4KICAgPHBhdGggZD0ibTEwMi40IDEyNy4xNS0xLjIxODggMS4wMDY1LTEuOTcyMS0wLjM4NDQ2di0xLjI0NDJsMS45NzIxLTAuMzg0NDZ6IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAiLz4KICA8L2c+CiA8L2c+Cjwvc3ZnPgo=" />
    ///     * `poly://8,10,,4,1,orange` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSIgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiPgogIDxwYXRoIGQ9Im05OC41OCAxMjUuNDhoMy4xNzV2My44ODA2aC0zLjE3NXoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogIDxwYXRoIGQ9Im0xMDEuNTggMTI3LjQyLTEuNDExMSAxLjc2MzktMS40MTExLTEuNzYzOSAxLjQxMTEtMS43NjM5eiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmZhNTAwIi8+CiA8L2c+Cjwvc3ZnPgo=" />
    /// 
    /// * `star://<width>[,<height>],<colour>[,<tips>[,<stroke thickness>[,<stroke colour>]]]`
    /// 
    ///     This draws a star with the specified width, height, colour and number of tips. The `stroke thickness`
    ///     and `stroke colour` parameters can be omitted, in which case the star will only be filled and not stroked.
    ///     If the `height` is omitted, it will be equal to the `width`. If the number of `sides` is omitted, it will be
    ///     equal to `5`.
    /// 
    ///     Examples:
    /// 
    ///     * `star://8,cornflowerblue` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSI+CiAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLS4xMjkyOSAuMjQ0ODkpIiBzdHJva2Utd2lkdGg9Ii4zNTI3OCI+CiAgIDxwYXRoIGQ9Im05OC44ODYgMTI1Ljc2aDIuODIyMnYyLjgyMjJoLTIuODIyMnoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogICA8cGF0aCBkPSJtMTAxLjcxIDEyNy4xNy0wLjg0MDMgMC40MTQ3Mi0wLjEzNDc1IDAuOTI3MzMtMC42NTQwOS0wLjY3MTAyLTAuOTIzNTggMC4xNTg0IDAuNDM2MDYtMC44Mjk0My0wLjQzNjA2LTAuODI5NDMgMC45MjM1OCAwLjE1ODQxIDAuNjU0MDktMC42NzEwMiAwLjEzNDc1IDAuOTI3MzN6IiBmaWxsPSIjNjQ5NWVkIi8+CiAgPC9nPgogPC9nPgo8L3N2Zz4K" />
    ///     * `star://10,6,#009e76,3,1,black` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSI+CiAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLjkzNDc4IC4zNzM1MikiIHN0cm9rZS13aWR0aD0iLjM1Mjc4Ij4KICAgPHBhdGggZD0ibTk3LjI5MyAxMjUuODFoMy44ODA2djIuNDY5NGgtMy44ODA2eiIgZmlsbD0iI2ZmZiIgZmlsbC1vcGFjaXR5PSIwIi8+CiAgIDxwYXRoIGQ9Im0xMDEgMTI3LjA0LTAuOTQ5MDggMC4yMDI1MSAwLjQzMjQ1IDAuNTQ1ODUtMC45MDk3NS0wLjI1OTQ3LTAuMzM3NSAwLjU2OTQ1LTAuMzM3NTEtMC41Njk0NS0wLjkwOTc1IDAuMjU5NDcgMC40MzI0NS0wLjU0NTg1LTAuOTQ5MDgtMC4yMDI1MSAwLjk0OTA4LTAuMjAyNS0wLjQzMjQ1LTAuNTQ1ODUgMC45MDk3NSAwLjI1OTQ3IDAuMzM3NTEtMC41Njk0NSAwLjMzNzUgMC41Njk0NSAwLjkwOTc1LTAuMjU5NDctMC40MzI0NSAwLjU0NTg1eiIgZmlsbD0iIzAwOWU3NiIvPgogICA8cGF0aCBkPSJtMTAxIDEyNy4wNC0wLjk0OTA4IDAuMjAyNTEgMC40MzI0NSAwLjU0NTg1LTAuOTA5NzUtMC4yNTk0Ny0wLjMzNzUgMC41Njk0NS0wLjMzNzUxLTAuNTY5NDUtMC45MDk3NSAwLjI1OTQ3IDAuNDMyNDUtMC41NDU4NS0wLjk0OTA4LTAuMjAyNTEgMC45NDkwOC0wLjIwMjUtMC40MzI0NS0wLjU0NTg1IDAuOTA5NzUgMC4yNTk0NyAwLjMzNzUxLTAuNTY5NDUgMC4zMzc1IDAuNTY5NDUgMC45MDk3NS0wLjI1OTQ3LTAuNDMyNDUgMC41NDU4NXoiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiLz4KICA8L2c+CiA8L2c+Cjwvc3ZnPgo=" />
    ///     * `star://8,10,,4,1,orange` <img height="50" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNi41bW0iIGhlaWdodD0iNi41bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYuNSA2LjUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogPG1ldGFkYXRhPgogIDxyZGY6UkRGPgogICA8Y2M6V29yayByZGY6YWJvdXQ9IiI+CiAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzp0aXRsZS8+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk2LjkxOCAtMTI0LjE3KSIgc3Ryb2tlLXdpZHRoPSIuMzUyNzgiPgogIDxwYXRoIGQ9Im05OC41OCAxMjUuNDhoMy4xNzV2My44ODA2aC0zLjE3NXoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMCIvPgogIDxwYXRoIGQ9Im0xMDEuNTggMTI3LjQyLTAuOTEyMiAwLjYyMzYzLTAuNDk4OSAxLjE0MDMtMC40OTg5MS0xLjE0MDMtMC45MTIyMS0wLjYyMzYzIDAuOTEyMjEtMC42MjM2MyAwLjQ5ODkxLTEuMTQwMyAwLjQ5ODkgMS4xNDAzeiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmZhNTAwIi8+CiA8L2c+Cjwvc3ZnPgo=" />
    /// ]]>
    /// </description>
    public static class MyModule
    {
        public const string Name = "Legend";
        public const string HelpText = "Draws a Markdown legend.";
        public const string Author = "Giorgio Bianchini";
        public static Version Version = new Version("1.0.0");
        public const ModuleTypes ModuleType = ModuleTypes.Plotting;

        public const string Id = "06888353-e930-4d08-ab24-5727bced8cd6";

        public static List<(string, string)> GetParameters(TreeNode tree)
        {
            List<string> leafNames = tree.GetLeafNames();

            return new List<(string, string)>()
            {
                ( "StateData", "InstanceStateData:" ),

                /// <param name="Markdown source:">
                /// This parameter is used to specify the Markdown source code for the legend that is drawn on the plot.
                /// See [Further information](#further-information) for instructions on how to include some common
                /// symbols in this; if you wish to include more complicated things, you can create them in a graphics
                /// software, include them as attachments, and use the `attachment://` syntax.
                /// </param>
                ( "Markdown source:", "Markdown:### **Legend**\n\n* ![](circle://8,#CC79A7) Red circle\n* ![](square://8,#0072B2) Blue square\n* ![](star://8,#009E73) Green star" ),

                /// <param name="Background colour:">
                /// The background colour for the legend.
                /// </param>
                ( "Background colour:", "Colour:[255, 255, 255, 255]" ),

                ( "Text", "Group:2" ),
                
                /// <param name="Font size:">
                /// The base font size used to render the legend. Headers use a larger font.
                /// </param>
                ( "Font size:", "NumericUpDown:14[\"0\", \"Infinity\"]" ),
                
                /// <param name="Colour:  " display="Text colour">
                /// The colour of the text in the legend.
                /// </param>
                ( "Colour:  ", "Colour:[0, 0, 0, 255]" ),

                ( "Layout", "Group:2" ),
                
                /// <param name="Width:">
                /// The width of the legend (the height is computed automatically).
                /// </param>
                ( "Width:", "NumericUpDown:200[\"0\", \"Infinity\"]" ),

                ( "Margin", "Group:4" ),
                
                /// <param name="Left:" display="Left margin">
                /// The left margin of the legend. Note that this can be &lt; 0.
                /// </param>
                ( "Left:", "NumericUpDown:5[\"-Infinity\", \"Infinity\"]" ),
                
                /// <param name="Top:" display="Top margin">
                /// The top margin of the legend. Note that this can be &lt; 0.
                /// </param>
                ( "Top:", "NumericUpDown:5[\"-Infinity\", \"Infinity\"]" ),
                
                /// <param name="Right:" display="Right margin">
                /// The right margin of the legend. Note that this can be &lt; 0.
                /// </param>
                ( "Right:", "NumericUpDown:5[\"-Infinity\", \"Infinity\"]" ),
                
                /// <param name="Bottom:" display="Bottom margin">
                /// The bottom margin of the legend. Note that this can be &lt; 0, which is useful to counter excessive space
                /// after the last text line.
                /// </param>
                ( "Bottom:", "NumericUpDown:-5[\"-Infinity\", \"Infinity\"]" ),

                ( "Border", "Group:2" ),
                
                /// <param name="Colour: " display="Border colour">
                /// The colour of the border drawn around the legend.
                /// </param>
                ( "Colour: ", "Colour:[0, 0, 0, 255]" ),
                
                /// <param name="Thickness: " display="Border thickness">
                /// The thickness of the border drawn around the legend.
                /// </param>
                ( "Thickness: ", "NumericUpDown:0[\"0\", \"Infinity\"]" ),

                ( "Header lines", "Group:2" ),
                
                /// <param name="Colour:" display="Header line colour">
                /// The colour of the line drawn below headers in the legend.
                /// </param>
                ( "Colour:", "Colour:[180, 180, 180, 255]" ),
                
                /// <param name="Thickness:" display="Header line thickness">
                /// The thickness of the line drawn below headers in the legend.
                /// </param>
                ( "Thickness:", "NumericUpDown:0[\"0\", \"Infinity\"]" ),

                ("Position","Group:4"),
                
                /// <param name="Anchor:">
                /// This parameter is used to select the anchor used to determine the position of the legend. If
                /// the selected value is `Node`, the specified node is used as an anchor. Otherwise, the selected point
                /// on the tree plot is used. Note that these positions refer to the _tree_ plot and do not take into
                /// account the presence of labels and other elements.
                /// </param>
                ("Anchor:","ComboBox:8[\"Node\",\"Top-left\",\"Top-center\",\"Top-right\",\"Middle-left\",\"Middle-center\",\"Middle-right\",\"Bottom-left\",\"Bottom-center\",\"Bottom-right\"]"),
                
                /// <param name="Node:">
                /// If the [Anchor](#anchor) was set to `Node`, this control is used to select the node that acts as an
                /// anchor.
                /// </param>
                ("Node:","Node:[\"" + leafNames[0] +"\",\"" + leafNames[^1] + "\"]"),
                
                /// <param name="Alignment:">
                /// This parameter controls to which point on the legend the selected [Anchor](#anchor) corresponds.
                /// </param>
                ("Alignment:","ComboBox:1[\"Top-left\",\"Top-center\",\"Top-right\",\"Middle-left\",\"Middle-center\",\"Middle-right\",\"Bottom-left\",\"Bottom-center\",\"Bottom-right\"]"),
                
                /// <param name="Position:">
                /// This parameter determines how much the legend is shifted with respect to the position determined
                /// by the [Anchor](#anchor) and the [Alignment](#alignment).
                /// </param>
                ("Position:","Point:[0,10]"),

            };
        }

        public static bool OnParameterChange(object tree, Dictionary<string, object> previousParameterValues, Dictionary<string, object> currentParameterValues, out Dictionary<string, ControlStatus> controlStatus, out Dictionary<string, object> parametersToChange)
        {
            controlStatus = new Dictionary<string, ControlStatus>();
            parametersToChange = new Dictionary<string, object>();

            if ((int)currentParameterValues["Anchor:"] == 0)
            {
                controlStatus["Node:"] = ControlStatus.Enabled;
            }
            else
            {
                controlStatus["Node:"] = ControlStatus.Hidden;
            }

            return true;
        }

        public static Point[] PlotAction(TreeNode tree, Dictionary<string, object> parameterValues, Dictionary<string, Point> coordinates, Graphics graphics)
        {
            string text = (string)parameterValues["Markdown source:"];

            Colour headerLineColour = (Colour)parameterValues["Colour:"];
            double headerLineThickness = (double)parameterValues["Thickness:"];

            Colour backgroundColour = (Colour)parameterValues["Background colour:"];
            Colour borderColour = (Colour)parameterValues["Colour: "];
            double borderThickness = (double)parameterValues["Thickness: "];

            double width = (double)parameterValues["Width:"];
            double marginLeft = (double)parameterValues["Left:"];
            double marginTop = (double)parameterValues["Top:"];
            double marginRight = (double)parameterValues["Right:"];
            double marginBottom = (double)parameterValues["Bottom:"];

            double fontSize = (double)parameterValues["Font size:"];
            Colour textColour = (Colour)parameterValues["Colour:  "];

            InstanceStateData stateData = (InstanceStateData)parameterValues["StateData"];

            TreeNode anchorNode = (tree.GetLastCommonAncestor((string[])parameterValues["Node:"]) ?? tree);

            int anchorType = (int)parameterValues["Anchor:"];
            int alignment = (int)parameterValues["Alignment:"];

            double plotMaxX = double.MinValue;
            double plotMinX = double.MaxValue;
            double plotMaxY = double.MinValue;
            double plotMinY = double.MaxValue;

            foreach (KeyValuePair<string, Point> kvp in coordinates)
            {
                if (tree.GetNodeFromId(kvp.Key) != null)
                {
                    plotMaxX = Math.Max(plotMaxX, kvp.Value.X);
                    plotMaxY = Math.Max(plotMaxY, kvp.Value.Y);
                    plotMinX = Math.Min(plotMinX, kvp.Value.X);
                    plotMinY = Math.Min(plotMinY, kvp.Value.Y);
                }
            }

            double anchorX = coordinates[Modules.RootNodeId].X;
            double anchorY = coordinates[Modules.RootNodeId].Y;

            if (anchorType == 0)
            {
                Point anchor = coordinates[anchorNode.Id];
                anchorX = anchor.X;
                anchorY = anchor.Y;
            }
            else
            {
                if (anchorType == 1 || anchorType == 2 || anchorType == 3)
                {
                    anchorY = plotMinY;
                }
                else if (anchorType == 4 || anchorType == 5 || anchorType == 6)
                {
                    anchorY = (plotMinY + plotMaxY) * 0.5;
                }
                else if (anchorType == 7 || anchorType == 8 || anchorType == 9)
                {
                    anchorY = plotMaxY;
                }

                if (anchorType == 1 || anchorType == 4 || anchorType == 7)
                {
                    anchorX = plotMinX;
                }
                else if (anchorType == 2 || anchorType == 5 || anchorType == 8)
                {
                    anchorX = (plotMinX + plotMaxX) * 0.5;
                }
                else if (anchorType == 3 || anchorType == 6 || anchorType == 9)
                {
                    anchorX = plotMaxX;
                }
            }

            Point position = (Point)parameterValues["Position:"];


            MarkdownRenderer renderer = MarkdownUtils.GetMarkdownRenderer(stateData);
            renderer.HeaderLineColour = headerLineColour;
            for (int i = 0; i < renderer.HeaderLineThicknesses.Length; i++)
            {
                renderer.HeaderLineThicknesses[i] *= headerLineThickness;
            }
            renderer.Margins = new Margins(marginLeft, marginTop, marginRight, marginBottom);
            renderer.BackgroundColour = backgroundColour;
            renderer.BaseFontSize = fontSize;
            renderer.ImageMultiplier = fontSize / 10.5;
            renderer.ForegroundColour = textColour;
            renderer.ThematicBreakLineColour = headerLineColour;

            Page pag = renderer.RenderSinglePage(text, width, out _);

            double plotPosX = 0;
            double plotPosY = 0;

            if (alignment == 0 || alignment == 1 || alignment == 2)
            {
                plotPosY = 0;
            }
            else if (alignment == 3 || alignment == 4 || alignment == 5)
            {
                plotPosY = -pag.Height * 0.5;
            }
            else if (alignment == 6 || alignment == 7 || alignment == 8)
            {
                plotPosY = -pag.Height;
            }

            if (alignment == 0 || alignment == 3 || alignment == 6)
            {
                plotPosX = 0;
            }
            else if (alignment == 1 || alignment == 4 || alignment == 7)
            {
                plotPosX = -pag.Width * 0.5;
            }
            else if (alignment == 2 || alignment == 5 || alignment == 8)
            {
                plotPosX = -pag.Width;
            }

            if (backgroundColour.A > 0)
            {
                graphics.FillRectangle(position.X + anchorX + plotPosX, position.Y + anchorY + plotPosY, pag.Width, pag.Height, backgroundColour);
            }

            if (borderThickness > 0 && borderColour.A > 0)
            {
                graphics.StrokeRectangle(position.X + anchorX + plotPosX, position.Y + anchorY + plotPosY, pag.Width, pag.Height, borderColour, borderThickness);
            }

            graphics.DrawGraphics(position.X + anchorX + plotPosX, position.Y + anchorY + plotPosY, pag.Graphics);

            Point topLeft = new Point(position.X + anchorX + plotPosX - borderThickness, position.Y + anchorY + plotPosY - borderThickness);
            Point bottomRight = new Point(topLeft.X + pag.Width + borderThickness, topLeft.Y + pag.Height + borderThickness);

            return new Point[] { topLeft, bottomRight };
        }
    }
}